<!doctype>
<html>
  <head>
    <title>Search</title>
  </head>
  <body>

    <h1>Search for food</h1>
    <form action="#" id='searchForm'>
      <label for="search">Search</label>
      <input placeholder="Search"
        name="query"
        value="pizza"
        type="search" />

      <label for="location">City</label>
      <input 
        type="text" name="location"
        value="San Francisco" 
        placeholder="Address"
        id="location" />
      
      <input type="submit" value="Search" />
    </form>
    <div id="list"></div>


    <script type="text/javascript">
      const container = document.querySelector('#list')

      function updateList(items) {
        let content = '<div class="ui items">'
        const itemList = items.map(item => {
          return '<div class="item">' + 
            '<img src="' + item.image_url + '" />' +
            '<h2>' + item.name + '</h2>' +
            '</div>'
        })
        content += itemList
        content += '</div>'
        container.innerHTML = content;
      }
      function search(evt) {
        evt.preventDefault();

        const form = new FormData(this);
        fetch('/search', {
          method: 'POST', 
          body: form
        })
        .then(res => res.json())
        .then(json => json.businesses)
        .then(updateList)
        .catch(err => {
          console.log('err ->', err);
        })
      }
      document.querySelector('#searchForm')
        .addEventListener('submit', search);
    </script>

  </body>
</html>